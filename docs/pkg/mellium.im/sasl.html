<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Package: mellium.im/sasl</title>
<link href="../../css/light-v0.3.6.css" rel="stylesheet">
<script src="../../jvs/golds-v0.3.6.js"></script>
<body onload="onPageLoad()"><div>

<pre id="package-details"><code><span style="font-size:xx-large;">package <b>sasl</b></span>

<span class="title">Import Path</span>
	<a href="../../index.html#pkg-mellium.im/sasl">mellium.im/sasl</a><i> (on <a href="https://pkg.go.dev/mellium.im/sasl" target="_blank">go.dev</a>)</i>

<span class="title">Dependency Relation</span>
	imports <a href="../../dep/mellium.im/sasl.html">14 packages</a>, and imported by <a href="../../dep/mellium.im/sasl.html#imported-by">one package</a>

<div id="files"><span class="title">Involved Source Files</span>

	<input type='checkbox' checked class="fold" id="file-0-fold-content"><label for="file-0-fold-content">   <a href="../../src/mellium.im/sasl/doc.go.html#doc">#d</a> <a href="../../src/mellium.im/sasl/doc.go.html">doc.go</a></label><span id='file-0-fold-content-items' class="fold-items">
		Package sasl implements the Simple Authentication and Security Layer (SASL)
		as defined by RFC 4422.

		Most users of this package will only need to create a Negotiator using
		NewClient or NewServer and call its Step method repeatedly.
		Authors implementing SASL mechanisms other than the builtin ones will want to
		create a Mechanism struct which will likely use the other methods on the
		Negotiator.

		Be advised: This API is still unstable and is subject to change.
</span>
	<span class="nodocs">      <a href="../../src/mellium.im/sasl/mechanism.go.html">mechanism.go</a></span>
	<span class="nodocs">      <a href="../../src/mellium.im/sasl/negotiator.go.html">negotiator.go</a></span>
	<span class="nodocs">      <a href="../../src/mellium.im/sasl/nonce.go.html">nonce.go</a></span>
	<span class="nodocs">      <a href="../../src/mellium.im/sasl/options.go.html">options.go</a></span>
	<span class="nodocs">      <a href="../../src/mellium.im/sasl/plain.go.html">plain.go</a></span>
	<span class="nodocs">      <a href="../../src/mellium.im/sasl/scram.go.html">scram.go</a></span>
	<span class="nodocs">      <a href="../../src/mellium.im/sasl/xor_unaligned.go.html">xor_unaligned.go</a></span></div>
<div id="examples"><span class="title">Code Examples</span>

	<input type='checkbox' class="fold" id="example-0-fold-content"><label for="example-0-fold-content">_plainFailure</label><span id='example-0-fold-content-items' class="fold-items">
		package main
		
		import (
			"fmt"
			"mellium.im/sasl"
		)
		
		func main() {
			const (
				username = "miranda"
				password = "pencil"
			)
		
			creds := sasl.Credentials(func() ([]byte, []byte, []byte) {
				return []byte(username), []byte(password), []byte{}
			})
		
			server := sasl.NewServer(sasl.Plain, func(n *sasl.Negotiator) bool {
				user, pass, ident := n.Credentials()
				// In a real auth system you might want to consider a constant time
				// comparison and this would probably involve hashing and a database lookup.
				if len(ident) == 0 && string(user) == username && string(pass) == password {
					fmt.Println("auth success!")
					return true
				}
				fmt.Println("auth failed!")
				return false
			}, creds)
		
			client := sasl.NewClient(sasl.Plain, sasl.Credentials(func() ([]byte, []byte, []byte) {
				// In a real auth system this would probably be user input.
				return []byte(username), []byte("password!"), []byte{}
			}))
		
			_, resp, err := client.Step(nil)
			if err != nil {
				fmt.Println(err)
				return
			}
		
			// Normally the response would come from the network, not from a client on the
			// same machine.
			_, resp, err = server.Step(resp)
			if err != sasl.ErrAuthn {
				fmt.Println(err)
				return
			}
		
		}
</span>
	<input type='checkbox' class="fold" id="example-1-fold-content"><label for="example-1-fold-content">_plainSuccess</label><span id='example-1-fold-content-items' class="fold-items">
		package main
		
		import (
			"fmt"
			"mellium.im/sasl"
		)
		
		func main() {
			const (
				username = "miranda"
				password = "pencil"
			)
		
			creds := sasl.Credentials(func() ([]byte, []byte, []byte) {
				// In a real auth system this would probably be user input.
				return []byte(username), []byte(password), []byte{}
			})
		
			server := sasl.NewServer(sasl.Plain, func(n *sasl.Negotiator) bool {
				user, pass, ident := n.Credentials()
				// In a real auth system you might want to consider a constant time
				// comparison and this would probably involve hashing and a database lookup.
				if len(ident) == 0 && string(user) == username && string(pass) == password {
					fmt.Println("auth success!")
					return true
				}
				fmt.Println("auth failed!")
				return false
			}, creds)
		
			client := sasl.NewClient(sasl.Plain, creds)
		
			_, resp, err := client.Step(nil)
			if err != nil {
				fmt.Println(err)
				return
			}
		
			// Normally the response would come from the network, not from a client on the
			// same machine.
			_, resp, err = server.Step(resp)
			if err != nil {
				fmt.Println(err)
				return
			}
		
		}
</span>
	<input type='checkbox' class="fold" id="example-2-fold-content"><label for="example-2-fold-content">_xOAUTH2</label><span id='example-2-fold-content-items' class="fold-items">
		package main
		
		import (
			"bytes"
			"fmt"
		
			"mellium.im/sasl"
		)
		
		// A custom SASL Mechanism that implements XOAUTH2:
		// https://developers.google.com/gmail/xoauth2_protocol
		var xoauth2 = sasl.Mechanism{
			Name: "XOAUTH2",
			Start: func(m *sasl.Negotiator) (bool, []byte, interface{}, error) {
				// Start is called only by clients and returns the client first message.
		
				username, password, _ := m.Credentials()
		
				payload := []byte(`user=`)
				payload = append(payload, username...)
				payload = append(payload, '\x01')
				payload = append(payload, []byte(`auth=Bearer `)...)
				payload = append(payload, password...)
				payload = append(payload, '\x01', '\x01')
		
				return false, payload, nil, nil
			},
			Next: func(m *sasl.Negotiator, challenge []byte, _ interface{}) (bool, []byte, interface{}, error) {
				// Next is called by both clients and servers and must be able to generate
				// and handle every challenge except for the client first message which is
				// generated (but not handled by) by Start.
		
				state := m.State()
		
				// If we're a client or a server that's past the AuthTextSent step, we
				// should never actually hit this step for the XOAUTH2 mechanism so return
				// an error.
				if state&sasl.Receiving != sasl.Receiving || state&sasl.StepMask != sasl.AuthTextSent {
					return false, nil, nil, sasl.ErrTooManySteps
				}
		
				parts := bytes.Split(challenge, []byte{1})
				if len(parts) != 3 {
					return false, nil, nil, sasl.ErrInvalidChallenge
				}
				user := bytes.TrimPrefix([]byte("user="), parts[0])
				if len(user) == len(parts[0]) {
					return false, nil, nil, sasl.ErrInvalidChallenge
				}
				pass := bytes.TrimPrefix([]byte("Auth=Bearer "), parts[1])
				if len(pass) == len(parts[1]) {
					return false, nil, nil, sasl.ErrInvalidChallenge
				}
				if len(parts[2]) > 0 {
					return false, nil, nil, sasl.ErrInvalidChallenge
				}
		
				if m.Permissions(sasl.Credentials(func() ([]byte, []byte, []byte) {
					return user, pass, nil
				})) {
					return false, nil, nil, nil
				}
				return false, nil, nil, sasl.ErrAuthn
			},
		}
		
		func main() {
			c := sasl.NewClient(
				xoauth2,
				sasl.Credentials(func() ([]byte, []byte, []byte) {
					return []byte("someuser@example.com"), []byte("vF9dft4qmTc2Nvb3RlckBhdHRhdmlzdGEuY29tCg=="), []byte{}
				}),
			)
		
			// This is the first step and we haven't received any challenge from the
			// server yet.
			more, resp, _ := c.Step(nil)
			fmt.Printf("%v %s", more, bytes.Replace(resp, []byte{1}, []byte{' '}, -1))
		
		}
</span>
</div>
<div id="exported-types"><span class="title">Package-Level Type Names<span class="title-stat"><i> (total 4, all are exported)</i></span></span>

<div id="exported-types-buttons" class="js-on">	/* sort exporteds by: <label id="sort-types-by-alphabet" class="button">alphabet</label> | <label id="sort-types-by-popularity" class="button">popularity</label> */</div><div class="anchor type-res" id="name-Mechanism" data-popularity="195">	<input type='checkbox' class="fold" id="Mechanism-fold-content"><label for="Mechanism-fold-content"> type <a href="../../src/mellium.im/sasl/mechanism.go.html#line-54">Mechanism</a> <i>(struct)</i></label><span id='Mechanism-fold-content-docs' class="fold-docs">
		Mechanism represents a SASL mechanism that can be used by a Client or Server
		to perform the actual negotiation. Base64 encoding the final challenges and
		responses should not be performed by the mechanism.

		Mechanisms must be stateless and may be shared between goroutines. When a
		mechanism needs to store state between the different steps it can return
		anything that it needs to store and the value will be cached by the
		negotiator and passed in as the data parameter when the next challenge is
		received.

		<input type='checkbox' class="fold" id="Mechanism-fold-fields"><label for="Mechanism-fold-fields">Fields (<i>total 3, all are exported</i>)</label><span id='Mechanism-fold-fields-items' class="fold-items"><span>
			<span class="nodocs"><a href="../../src/mellium.im/sasl/mechanism.go.html#line-55">Name</a> <i><a href="../builtin.html#name-string">string</a></i></span></span><span>
			<span class="nodocs"><a href="../../src/mellium.im/sasl/mechanism.go.html#line-57">Next</a> <i>func(n *<a href="#name-Negotiator">Negotiator</a>, challenge []<a href="../builtin.html#name-byte">byte</a>, data interface{}) (more <a href="../builtin.html#name-bool">bool</a>, resp []<a href="../builtin.html#name-byte">byte</a>, cache interface{}, err <a href="../builtin.html#name-error">error</a>)</i></span></span><span>
			<span class="nodocs"><a href="../../src/mellium.im/sasl/mechanism.go.html#line-56">Start</a> <i>func(n *<a href="#name-Negotiator">Negotiator</a>) (more <a href="../builtin.html#name-bool">bool</a>, resp []<a href="../builtin.html#name-byte">byte</a>, cache interface{}, err <a href="../builtin.html#name-error">error</a>)</i></span></span></span>
		<input type='checkbox' class="fold" id="Mechanism-fold-results"><label for="Mechanism-fold-results">As Outputs Of (<i>at least one unexported</i>)</label><span id='Mechanism-fold-results-items' class="fold-items">
			<input type='checkbox' class="showhide" id="Mechanism-showhide-inputofs"><i><label for="Mechanism-showhide-inputofs" class="show-inline">/* at least one unexported ... */</label><label for="Mechanism-showhide-inputofs" class="hide-inline">/* at least one unexported: */</label></i><span class="hidden"><i>
			func <a href="#name-scram">scram</a>(name <a href="../builtin.html#name-string">string</a>, fn func() <a href="../hash.html">hash</a>.<a href="../hash.html#name-Hash">Hash</a>) <b>Mechanism</b></i></span></span>
		<input type='checkbox' class="fold" id="Mechanism-fold-params"><label for="Mechanism-fold-params">As Inputs Of (<i>at least 3, in which 2 are exported</i>)</label><span id='Mechanism-fold-params-items' class="fold-items"><span>
			func <a href="#name-NewClient">NewClient</a>(m <b>Mechanism</b>, opts ...<a href="#name-Option">Option</a>) *<a href="#name-Negotiator">Negotiator</a></span><span>
			func <a href="#name-NewServer">NewServer</a>(m <b>Mechanism</b>, permissions func(*<a href="#name-Negotiator">Negotiator</a>) <a href="../builtin.html#name-bool">bool</a>, opts ...<a href="#name-Option">Option</a>) *<a href="#name-Negotiator">Negotiator</a></span>
			<input type='checkbox' class="showhide" id="Mechanism-showhide-outputofs"><i><label for="Mechanism-showhide-outputofs" class="show-inline">/* at least one unexported ... */</label><label for="Mechanism-showhide-outputofs" class="hide-inline">/* at least one unexported: */</label></i><span class="hidden"><i>
			func github.com/uptrace/bun/driver/pgdriver.<a href="../github.com/uptrace/bun/driver/pgdriver.html#name-saslWriteInitialResponse">saslWriteInitialResponse</a>(ctx <a href="../context.html">context</a>.<a href="../context.html#name-Context">Context</a>, cn *<a href="../github.com/uptrace/bun/driver/pgdriver.html">pgdriver</a>.<a href="../github.com/uptrace/bun/driver/pgdriver.html#name-Conn">Conn</a>, saslMech <b>Mechanism</b>, resp []<a href="../builtin.html#name-byte">byte</a>) <a href="../builtin.html#name-error">error</a></i></span></span>
		<input type='checkbox' class="fold" id="Mechanism-fold-values"><label for="Mechanism-fold-values">As Types Of (<i>total 6, in which 5 are exported</i>)</label><span id='Mechanism-fold-values-items' class="fold-items"><span>
			  var <a href="#name-Plain">Plain</a></span><span>
			  var <a href="#name-ScramSha1">ScramSha1</a></span><span>
			  var <a href="#name-ScramSha1Plus">ScramSha1Plus</a></span><span>
			  var <a href="#name-ScramSha256">ScramSha256</a></span><span>
			  var <a href="#name-ScramSha256Plus">ScramSha256Plus</a></span>
			<input type='checkbox' class="showhide" id="Mechanism-showhide-values"><i><label for="Mechanism-showhide-values" class="show-inline">/* one unexported ... */</label><label for="Mechanism-showhide-values" class="hide-inline">/* one unexported: */</label></i><span class="hidden"><i>
			  var <a href="#name-plain">plain</a></i></span></span>

</span></div><div class="anchor type-res" id="name-Negotiator" data-popularity="655">	<input type='checkbox' class="fold" id="Negotiator-fold-content"><label for="Negotiator-fold-content"> type <a href="../../src/mellium.im/sasl/negotiator.go.html#line-87">Negotiator</a> <i>(struct)</i></label><span id='Negotiator-fold-content-docs' class="fold-docs">
		A Negotiator represents a SASL client or server state machine that can
		attempt to negotiate auth. Negotiators should not be used from multiple
		goroutines, and must be reset between negotiation attempts.

		<input type='checkbox' class="fold" id="Negotiator-fold-fields"><label for="Negotiator-fold-fields">Fields (<i>total 8, none are exported</i>)</label><span id='Negotiator-fold-fields-items' class="fold-items">
			<input type='checkbox' class="showhide" id="Negotiator-showhide-fields"><i><label for="Negotiator-showhide-fields" class="show-inline">/* 8 unexporteds ... */</label><label for="Negotiator-showhide-fields" class="hide-inline">/* 8 unexporteds: */</label></i><span class="hidden"><i>
			<span class="nodocs"><a href="../../src/mellium.im/sasl/negotiator.go.html#line-95">cache</a> <i>interface{}</i></span></i></span><span class="hidden"><i>
			<span class="nodocs"><a href="../../src/mellium.im/sasl/negotiator.go.html#line-90">credentials</a> <i>func() (Username, Password, Identity []<a href="../builtin.html#name-byte">byte</a>)</i></span></i></span><span class="hidden"><i>
			<span class="nodocs"><a href="../../src/mellium.im/sasl/negotiator.go.html#line-92">mechanism</a> <i><a href="#name-Mechanism">Mechanism</a></i></span></i></span><span class="hidden"><i>
			<span class="nodocs"><a href="../../src/mellium.im/sasl/negotiator.go.html#line-94">nonce</a> <i>[]<a href="../builtin.html#name-byte">byte</a></i></span></i></span><span class="hidden"><i>
			<span class="nodocs"><a href="../../src/mellium.im/sasl/negotiator.go.html#line-91">permissions</a> <i>func(*<b>Negotiator</b>) <a href="../builtin.html#name-bool">bool</a></i></span></i></span><span class="hidden"><i>
			<span class="nodocs"><a href="../../src/mellium.im/sasl/negotiator.go.html#line-89">remoteMechanisms</a> <i>[]<a href="../builtin.html#name-string">string</a></i></span></i></span><span class="hidden"><i>
			<span class="nodocs"><a href="../../src/mellium.im/sasl/negotiator.go.html#line-93">state</a> <i><a href="#name-State">State</a></i></span></i></span><span class="hidden"><i>
			<span class="nodocs"><a href="../../src/mellium.im/sasl/negotiator.go.html#line-88">tlsState</a> <i>*<a href="../crypto/tls.html">tls</a>.<a href="../crypto/tls.html#name-ConnectionState">ConnectionState</a></i></span></i></span></span>
		<input type='checkbox' class="fold" id="Negotiator-fold-methods"><label for="Negotiator-fold-methods">Methods (<i>total 8, all are exported</i>)</label><span id='Negotiator-fold-methods-items' class="fold-items"><span>
			<input type='checkbox' class="fold" id="Negotiator-fold-method-Credentials"><label for="Negotiator-fold-method-Credentials">(*T) <a href="../../src/mellium.im/sasl/negotiator.go.html#line-159">Credentials</a>() (username, password, identity []<a href="../builtin.html#name-byte">byte</a>)</label><span id='Negotiator-fold-method-Credentials-docs' class="fold-docs">
				Credentials returns a username, and password for authentication and optional
				identity for authorization.
</span></span><span>
			<input type='checkbox' class="fold" id="Negotiator-fold-method-Nonce"><label for="Negotiator-fold-method-Nonce">(*T) <a href="../../src/mellium.im/sasl/negotiator.go.html#line-100">Nonce</a>() []<a href="../builtin.html#name-byte">byte</a></label><span id='Negotiator-fold-method-Nonce-docs' class="fold-docs">
				Nonce returns a unique nonce that is reset for each negotiation attempt. It
				is used by SASL Mechanisms and should generally not be called directly.
</span></span><span>
			<input type='checkbox' class="fold" id="Negotiator-fold-method-Permissions"><label for="Negotiator-fold-method-Permissions">(*T) <a href="../../src/mellium.im/sasl/negotiator.go.html#line-167">Permissions</a>(opts ...<a href="#name-Option">Option</a>) <a href="../builtin.html#name-bool">bool</a></label><span id='Negotiator-fold-method-Permissions-docs' class="fold-docs">
				Permissions is the callback used by the server to authenticate the user.
</span></span><span>
			<input type='checkbox' class="fold" id="Negotiator-fold-method-RemoteMechanisms"><label for="Negotiator-fold-method-RemoteMechanisms">(*T) <a href="../../src/mellium.im/sasl/negotiator.go.html#line-187">RemoteMechanisms</a>() []<a href="../builtin.html#name-string">string</a></label><span id='Negotiator-fold-method-RemoteMechanisms-docs' class="fold-docs">
				RemoteMechanisms is a list of mechanisms as advertised by the other side of a
				SASL negotiation.
</span></span><span>
			<input type='checkbox' class="fold" id="Negotiator-fold-method-Reset"><label for="Negotiator-fold-method-Reset">(*T) <a href="../../src/mellium.im/sasl/negotiator.go.html#line-145">Reset</a>()</label><span id='Negotiator-fold-method-Reset-docs' class="fold-docs">
				Reset resets the state machine to its initial state so that it can be reused
				in another SASL exchange.
</span></span><span>
			<input type='checkbox' class="fold" id="Negotiator-fold-method-State"><label for="Negotiator-fold-method-State">(*T) <a href="../../src/mellium.im/sasl/negotiator.go.html#line-139">State</a>() <a href="#name-State">State</a></label><span id='Negotiator-fold-method-State-docs' class="fold-docs">
				State returns the internal state of the SASL state machine.
</span></span><span>
			<input type='checkbox' class="fold" id="Negotiator-fold-method-Step"><label for="Negotiator-fold-method-Step">(*T) <a href="../../src/mellium.im/sasl/negotiator.go.html#line-107">Step</a>(challenge []<a href="../builtin.html#name-byte">byte</a>) (more <a href="../builtin.html#name-bool">bool</a>, resp []<a href="../builtin.html#name-byte">byte</a>, err <a href="../builtin.html#name-error">error</a>)</label><span id='Negotiator-fold-method-Step-docs' class="fold-docs">
				Step attempts to transition the state machine to its next state. If Step is
				called after a previous invocation generates an error (and the state machine
				has not been reset to its initial state), Step panics.
</span></span><span>
			<input type='checkbox' class="fold" id="Negotiator-fold-method-TLSState"><label for="Negotiator-fold-method-TLSState">(*T) <a href="../../src/mellium.im/sasl/negotiator.go.html#line-178">TLSState</a>() *<a href="../crypto/tls.html">tls</a>.<a href="../crypto/tls.html#name-ConnectionState">ConnectionState</a></label><span id='Negotiator-fold-method-TLSState-docs' class="fold-docs">
				TLSState is the state of any TLS connections being used to negotiate SASL
				(it can be used for channel binding).
</span></span></span>
		<input type='checkbox' class="fold" id="Negotiator-fold-results"><label for="Negotiator-fold-results">As Outputs Of (<i>at least 2, both are exported</i>)</label><span id='Negotiator-fold-results-items' class="fold-items"><span>
			func <a href="#name-NewClient">NewClient</a>(m <a href="#name-Mechanism">Mechanism</a>, opts ...<a href="#name-Option">Option</a>) *<b>Negotiator</b></span><span>
			func <a href="#name-NewServer">NewServer</a>(m <a href="#name-Mechanism">Mechanism</a>, permissions func(*<b>Negotiator</b>) <a href="../builtin.html#name-bool">bool</a>, opts ...<a href="#name-Option">Option</a>) *<b>Negotiator</b></span></span>
		<input type='checkbox' class="fold" id="Negotiator-fold-params"><label for="Negotiator-fold-params">As Inputs Of (<i>at least 3, none are exported</i>)</label><span id='Negotiator-fold-params-items' class="fold-items">
			<input type='checkbox' class="showhide" id="Negotiator-showhide-outputofs"><i><label for="Negotiator-showhide-outputofs" class="show-inline">/* 3+ unexporteds ... */</label><label for="Negotiator-showhide-outputofs" class="hide-inline">/* 3+ unexporteds: */</label></i><span class="hidden"><i>
			func <a href="#name-getGS2Header">getGS2Header</a>(name <a href="../builtin.html#name-string">string</a>, n *<b>Negotiator</b>) (gs2Header []<a href="../builtin.html#name-byte">byte</a>)</i></span><span class="hidden"><i>
			func <a href="#name-getOpts">getOpts</a>(n *<b>Negotiator</b>, o ...<a href="#name-Option">Option</a>)</i></span><span class="hidden"><i>
			func <a href="#name-scramClientNext">scramClientNext</a>(name <a href="../builtin.html#name-string">string</a>, fn func() <a href="../hash.html">hash</a>.<a href="../hash.html#name-Hash">Hash</a>, m *<b>Negotiator</b>, challenge []<a href="../builtin.html#name-byte">byte</a>, data interface{}) (more <a href="../builtin.html#name-bool">bool</a>, resp []<a href="../builtin.html#name-byte">byte</a>, cache interface{}, err <a href="../builtin.html#name-error">error</a>)</i></span></span>

</span></div><div class="anchor type-res" id="name-Option" data-popularity="365">	<input type='checkbox' class="fold" id="Option-fold-content"><label for="Option-fold-content"> type <a href="../../src/mellium.im/sasl/options.go.html#line-12">Option</a> <i>(func)</i></label><span id='Option-fold-content-docs' class="fold-docs">
		An Option represents an input to a SASL state machine.

		<input type='checkbox' class="fold" id="Option-fold-results"><label for="Option-fold-results">As Outputs Of (<i>at least 3, all are exported</i>)</label><span id='Option-fold-results-items' class="fold-items"><span>
			func <a href="#name-Credentials">Credentials</a>(f func() (Username, Password, Identity []<a href="../builtin.html#name-byte">byte</a>)) <b>Option</b></span><span>
			func <a href="#name-RemoteMechanisms">RemoteMechanisms</a>(m ...<a href="../builtin.html#name-string">string</a>) <b>Option</b></span><span>
			func <a href="#name-TLSState">TLSState</a>(cs <a href="../crypto/tls.html">tls</a>.<a href="../crypto/tls.html#name-ConnectionState">ConnectionState</a>) <b>Option</b></span></span>
		<input type='checkbox' class="fold" id="Option-fold-params"><label for="Option-fold-params">As Inputs Of (<i>at least 4, in which 3 are exported</i>)</label><span id='Option-fold-params-items' class="fold-items"><span>
			func <a href="#name-NewClient">NewClient</a>(m <a href="#name-Mechanism">Mechanism</a>, opts ...<b>Option</b>) *<a href="#name-Negotiator">Negotiator</a></span><span>
			func <a href="#name-NewServer">NewServer</a>(m <a href="#name-Mechanism">Mechanism</a>, permissions func(*<a href="#name-Negotiator">Negotiator</a>) <a href="../builtin.html#name-bool">bool</a>, opts ...<b>Option</b>) *<a href="#name-Negotiator">Negotiator</a></span><span>
			func (*<a href="#name-Negotiator">Negotiator</a>).<a href="../../src/mellium.im/sasl/negotiator.go.html#line-167">Permissions</a>(opts ...<b>Option</b>) <a href="../builtin.html#name-bool">bool</a></span>
			<input type='checkbox' class="showhide" id="Option-showhide-outputofs"><i><label for="Option-showhide-outputofs" class="show-inline">/* at least one unexported ... */</label><label for="Option-showhide-outputofs" class="hide-inline">/* at least one unexported: */</label></i><span class="hidden"><i>
			func <a href="#name-getOpts">getOpts</a>(n *<a href="#name-Negotiator">Negotiator</a>, o ...<b>Option</b>)</i></span></span>

</span></div><div class="anchor type-res" id="name-State" data-popularity="90">	<input type='checkbox' class="fold" id="State-fold-content"><label for="State-fold-content"> type <a href="../../src/mellium.im/sasl/negotiator.go.html#line-17">State</a> <a href="../builtin.html#name-uint8">uint8</a> <i>(basic type)</i></label><span id='State-fold-content-docs' class="fold-docs">
		State represents the current state of a Negotiator.
		The first two bits represent the actual state of the state machine and the
		last 3 bits are a bitmask that define the machines behavior.
		The remaining bits should not be used.

		<input type='checkbox' class="fold" id="State-fold-results"><label for="State-fold-results">As Outputs Of (<i>at least one exported</i>)</label><span id='State-fold-results-items' class="fold-items"><span>
			func (*<a href="#name-Negotiator">Negotiator</a>).<a href="../../src/mellium.im/sasl/negotiator.go.html#line-139">State</a>() <b>State</b></span></span>
		<input type='checkbox' class="fold" id="State-fold-values"><label for="State-fold-values">As Types Of (<i>total 7, all are exported</i>)</label><span id='State-fold-values-items' class="fold-items"><span>
			const <a href="#name-AuthTextSent">AuthTextSent</a></span><span>
			const <a href="#name-Errored">Errored</a></span><span>
			const <a href="#name-Initial">Initial</a></span><span>
			const <a href="#name-Receiving">Receiving</a></span><span>
			const <a href="#name-RemoteCB">RemoteCB</a></span><span>
			const <a href="#name-ResponseSent">ResponseSent</a></span><span>
			const <a href="#name-ValidServerResponse">ValidServerResponse</a></span></span>

</span></div></div>
<div id="exported-functions"><span class="title">Package-Level Functions<span class="title-stat"><i> (total 12, in which 5 are exported)</i></span></span>

<div class="anchor value-res" id="name-Credentials">	<input type='checkbox' class="fold" id="Credentials-fold-content"><label for="Credentials-fold-content"> func <a href="../../src/mellium.im/sasl/options.go.html#line-49">Credentials</a>(f func() (Username, Password, Identity []<a href="../builtin.html#name-byte">byte</a>)) <a href="#name-Option">Option</a></label><span id='Credentials-fold-content-docs' class="fold-docs">
		Credentials provides the negotiator with a username and password to
		authenticate with and (optionally) an authorization identity.
		Identity will normally be left empty to act as the username.
		The Credentials function is called lazily and may be called multiple times by
		the mechanism.
		It is not memoized by the negotiator.

</span></div><div class="anchor value-res" id="name-NewClient">	<input type='checkbox' class="fold" id="NewClient-fold-content"><label for="NewClient-fold-content"> func <a href="../../src/mellium.im/sasl/negotiator.go.html#line-44">NewClient</a>(m <a href="#name-Mechanism">Mechanism</a>, opts ...<a href="#name-Option">Option</a>) *<a href="#name-Negotiator">Negotiator</a></label><span id='NewClient-fold-content-docs' class="fold-docs">
		NewClient creates a new SASL Negotiator that supports creating authentication
		requests using the given mechanism.

</span></div><div class="anchor value-res" id="name-NewServer">	<input type='checkbox' class="fold" id="NewServer-fold-content"><label for="NewServer-fold-content"> func <a href="../../src/mellium.im/sasl/negotiator.go.html#line-64">NewServer</a>(m <a href="#name-Mechanism">Mechanism</a>, permissions func(*<a href="#name-Negotiator">Negotiator</a>) <a href="../builtin.html#name-bool">bool</a>, opts ...<a href="#name-Option">Option</a>) *<a href="#name-Negotiator">Negotiator</a></label><span id='NewServer-fold-content-docs' class="fold-docs">
		NewServer creates a new SASL Negotiator that supports receiving
		authentication requests using the given mechanism.
		A nil permissions function is the same as a function that always returns
		false.

</span></div><div class="anchor value-res" id="name-RemoteMechanisms">	<input type='checkbox' class="fold" id="RemoteMechanisms-fold-content"><label for="RemoteMechanisms-fold-content"> func <a href="../../src/mellium.im/sasl/options.go.html#line-37">RemoteMechanisms</a>(m ...<a href="../builtin.html#name-string">string</a>) <a href="#name-Option">Option</a></label><span id='RemoteMechanisms-fold-content-docs' class="fold-docs">
		RemoteMechanisms sets a list of mechanisms supported by the remote client or
		server with which the state machine will be negotiating.
		It is used to determine if the server supports channel binding.

</span></div><div class="anchor value-res" id="name-TLSState">	<input type='checkbox' class="fold" id="TLSState-fold-content"><label for="TLSState-fold-content"> func <a href="../../src/mellium.im/sasl/options.go.html#line-28">TLSState</a>(cs <a href="../crypto/tls.html">tls</a>.<a href="../crypto/tls.html#name-ConnectionState">ConnectionState</a>) <a href="#name-Option">Option</a></label><span id='TLSState-fold-content-docs' class="fold-docs">
		TLSState lets the state machine negotiate channel binding with a TLS session
		if supported by the underlying mechanism.

</span></div>	<input type='checkbox' class="showhide" id="unexported-functions-showhide"><i><label for="unexported-functions-showhide" class="show-inline">/* 7 unexporteds ... */</label><label for="unexported-functions-showhide" class="hide-inline">/* 7 unexporteds: */</label></i><div class="anchor value-res hidden" id="name-getGS2Header"><i>	<span class="nodocs"> func <a href="../../src/mellium.im/sasl/scram.go.html#line-33">getGS2Header</a>(name <a href="../builtin.html#name-string">string</a>, n *<a href="#name-Negotiator">Negotiator</a>) (gs2Header []<a href="../builtin.html#name-byte">byte</a>)</span></i></div><div class="anchor value-res hidden" id="name-getOpts"><i>	<span class="nodocs"> func <a href="../../src/mellium.im/sasl/options.go.html#line-14">getOpts</a>(n *<a href="#name-Negotiator">Negotiator</a>, o ...<a href="#name-Option">Option</a>)</span></i></div><div class="anchor value-res hidden" id="name-nonce"><i>	<input type='checkbox' class="fold" id="nonce-fold-content"><label for="nonce-fold-content"> func <a href="../../src/mellium.im/sasl/nonce.go.html#line-14">nonce</a>(n <a href="../builtin.html#name-int">int</a>, r <a href="../io.html">io</a>.<a href="../io.html#name-Reader">Reader</a>) []<a href="../builtin.html#name-byte">byte</a></label><span id='nonce-fold-content-docs' class="fold-docs">
		Generates a nonce with n random bytes base64 encoded to ensure that it meets
		the criteria for inclusion in a SCRAM message.

</span></i></div><div class="anchor value-res hidden" id="name-scram"><i>	<span class="nodocs"> func <a href="../../src/mellium.im/sasl/scram.go.html#line-54">scram</a>(name <a href="../builtin.html#name-string">string</a>, fn func() <a href="../hash.html">hash</a>.<a href="../hash.html#name-Hash">Hash</a>) <a href="#name-Mechanism">Mechanism</a></span></i></div><div class="anchor value-res hidden" id="name-scramClientNext"><i>	<span class="nodocs"> func <a href="../../src/mellium.im/sasl/scram.go.html#line-103">scramClientNext</a>(name <a href="../builtin.html#name-string">string</a>, fn func() <a href="../hash.html">hash</a>.<a href="../hash.html#name-Hash">Hash</a>, m *<a href="#name-Negotiator">Negotiator</a>, challenge []<a href="../builtin.html#name-byte">byte</a>, data interface{}) (more <a href="../builtin.html#name-bool">bool</a>, resp []<a href="../builtin.html#name-byte">byte</a>, cache interface{}, err <a href="../builtin.html#name-error">error</a>)</span></i></div><div class="anchor value-res hidden" id="name-xorBytes"><i>	<input type='checkbox' class="fold" id="xorBytes-fold-content"><label for="xorBytes-fold-content"> func <a href="../../src/mellium.im/sasl/xor_unaligned.go.html#line-19">xorBytes</a>(dst, a, b []<a href="../builtin.html#name-byte">byte</a>) <a href="../builtin.html#name-int">int</a></label><span id='xorBytes-fold-content-docs' class="fold-docs">
		xorBytes xors in bulk. It only works on architectures that support unaligned
		read/writes.

</span></i></div><div class="anchor value-res hidden" id="name-xorWords"><i>	<input type='checkbox' class="fold" id="xorWords-fold-content"><label for="xorWords-fold-content"> func <a href="../../src/mellium.im/sasl/xor_unaligned.go.html#line-44">xorWords</a>(dst, a, b []<a href="../builtin.html#name-byte">byte</a>)</label><span id='xorWords-fold-content-docs' class="fold-docs">
		xorWords XORs multiples of 4 or 8 bytes (depending on architecture.) The
		arguments are assumed to be of equal length.

</span></i></div></div>
<div id="exported-variables"><span class="title">Package-Level Variables<span class="title-stat"><i> (total 13, in which 9 are exported)</i></span></span>

<div class="anchor value-res" id="name-ErrAuthn">	<input type='checkbox' class="fold" id="ErrAuthn-fold-content"><label for="ErrAuthn-fold-content">  var <a href="../../src/mellium.im/sasl/mechanism.go.html#line-17">ErrAuthn</a> <a href="../builtin.html#name-error">error</a></label><span id='ErrAuthn-fold-content-docs' class="fold-docs">
		Define common errors used by SASL mechanisms and negotiators.

</span></div><div class="anchor value-res" id="name-ErrInvalidChallenge">	<input type='checkbox' class="fold" id="ErrInvalidChallenge-fold-content"><label for="ErrInvalidChallenge-fold-content">  var <a href="../../src/mellium.im/sasl/mechanism.go.html#line-16">ErrInvalidChallenge</a> <a href="../builtin.html#name-error">error</a></label><span id='ErrInvalidChallenge-fold-content-docs' class="fold-docs">
		Define common errors used by SASL mechanisms and negotiators.

</span></div><div class="anchor value-res" id="name-ErrInvalidState">	<input type='checkbox' class="fold" id="ErrInvalidState-fold-content"><label for="ErrInvalidState-fold-content">  var <a href="../../src/mellium.im/sasl/mechanism.go.html#line-15">ErrInvalidState</a> <a href="../builtin.html#name-error">error</a></label><span id='ErrInvalidState-fold-content-docs' class="fold-docs">
		Define common errors used by SASL mechanisms and negotiators.

</span></div><div class="anchor value-res" id="name-ErrTooManySteps">	<input type='checkbox' class="fold" id="ErrTooManySteps-fold-content"><label for="ErrTooManySteps-fold-content">  var <a href="../../src/mellium.im/sasl/mechanism.go.html#line-18">ErrTooManySteps</a> <a href="../builtin.html#name-error">error</a></label><span id='ErrTooManySteps-fold-content-docs' class="fold-docs">
		Define common errors used by SASL mechanisms and negotiators.

</span></div><div class="anchor value-res" id="name-Plain">	<input type='checkbox' class="fold" id="Plain-fold-content"><label for="Plain-fold-content">  var <a href="../../src/mellium.im/sasl/mechanism.go.html#line-24">Plain</a> <a href="#name-Mechanism">Mechanism</a></label><span id='Plain-fold-content-docs' class="fold-docs">
		Plain is a Mechanism that implements the PLAIN authentication mechanism
		as defined by RFC 4616.

</span></div><div class="anchor value-res" id="name-ScramSha1">	<input type='checkbox' class="fold" id="ScramSha1-fold-content"><label for="ScramSha1-fold-content">  var <a href="../../src/mellium.im/sasl/mechanism.go.html#line-42">ScramSha1</a> <a href="#name-Mechanism">Mechanism</a></label><span id='ScramSha1-fold-content-docs' class="fold-docs">
		ScramSha1 is a Mechanism that implements the SCRAM-SHA-1 authentication
		mechanism defined in RFC 5802.

</span></div><div class="anchor value-res" id="name-ScramSha1Plus">	<input type='checkbox' class="fold" id="ScramSha1Plus-fold-content"><label for="ScramSha1Plus-fold-content">  var <a href="../../src/mellium.im/sasl/mechanism.go.html#line-38">ScramSha1Plus</a> <a href="#name-Mechanism">Mechanism</a></label><span id='ScramSha1Plus-fold-content-docs' class="fold-docs">
		ScramSha1Plus is a Mechanism that implements the SCRAM-SHA-1-PLUS
		authentication mechanism defined in RFC 5802. The only supported channel
		binding type is tls-unique as defined in RFC 5929.

</span></div><div class="anchor value-res" id="name-ScramSha256">	<input type='checkbox' class="fold" id="ScramSha256-fold-content"><label for="ScramSha256-fold-content">  var <a href="../../src/mellium.im/sasl/mechanism.go.html#line-33">ScramSha256</a> <a href="#name-Mechanism">Mechanism</a></label><span id='ScramSha256-fold-content-docs' class="fold-docs">
		ScramSha256 is a Mechanism that implements the SCRAM-SHA-256
		authentication mechanism defined in RFC 7677.

</span></div><div class="anchor value-res" id="name-ScramSha256Plus">	<input type='checkbox' class="fold" id="ScramSha256Plus-fold-content"><label for="ScramSha256Plus-fold-content">  var <a href="../../src/mellium.im/sasl/mechanism.go.html#line-29">ScramSha256Plus</a> <a href="#name-Mechanism">Mechanism</a></label><span id='ScramSha256Plus-fold-content-docs' class="fold-docs">
		ScramSha256Plus is a Mechanism that implements the SCRAM-SHA-256-PLUS
		authentication mechanism defined in RFC 7677. The only supported channel
		binding type is tls-unique as defined in RFC 5929.

</span></div>	<input type='checkbox' class="showhide" id="unexported-variables-showhide"><i><label for="unexported-variables-showhide" class="show-inline">/* 4 unexporteds ... */</label><label for="unexported-variables-showhide" class="hide-inline">/* 4 unexporteds: */</label></i><div class="anchor value-res hidden" id="name-clientKeyInput"><i>	<span class="nodocs">  var <a href="../../src/mellium.im/sasl/scram.go.html#line-26">clientKeyInput</a> []<a href="../builtin.html#name-byte">byte</a></span></i></div><div class="anchor value-res hidden" id="name-plain"><i>	<span class="nodocs">  var <a href="../../src/mellium.im/sasl/plain.go.html#line-13">plain</a> <a href="#name-Mechanism">Mechanism</a></span></i></div><div class="anchor value-res hidden" id="name-plainSep"><i>	<span class="nodocs">  var <a href="../../src/mellium.im/sasl/plain.go.html#line-11">plainSep</a> []<a href="../builtin.html#name-byte">byte</a></span></i></div><div class="anchor value-res hidden" id="name-serverKeyInput"><i>	<span class="nodocs">  var <a href="../../src/mellium.im/sasl/scram.go.html#line-27">serverKeyInput</a> []<a href="../builtin.html#name-byte">byte</a></span></i></div></div>
<div id="exported-constants"><span class="title">Package-Level Constants<span class="title-stat"><i> (total 13, in which 8 are exported)</i></span></span>

<div class="anchor value-res" id="name-AuthTextSent">	<input type='checkbox' class="fold" id="AuthTextSent-fold-content"><label for="AuthTextSent-fold-content">const <a href="../../src/mellium.im/sasl/negotiator.go.html#line-23">AuthTextSent</a> <a href="#name-State">State</a> = 1</label><span id='AuthTextSent-fold-content-docs' class="fold-docs">
		The current step of the Server or Client (represented by the first two bits
		of the state byte).

</span></div><div class="anchor value-res" id="name-Errored">	<input type='checkbox' class="fold" id="Errored-fold-content"><label for="Errored-fold-content">const <a href="../../src/mellium.im/sasl/negotiator.go.html#line-36">Errored</a> <a href="#name-State">State</a> = 16</label><span id='Errored-fold-content-docs' class="fold-docs">
		Errored bit is on if the machine has errored.

</span></div><div class="anchor value-res" id="name-Initial">	<input type='checkbox' class="fold" id="Initial-fold-content"><label for="Initial-fold-content">const <a href="../../src/mellium.im/sasl/negotiator.go.html#line-22">Initial</a> <a href="#name-State">State</a> = 0</label><span id='Initial-fold-content-docs' class="fold-docs">
		The current step of the Server or Client (represented by the first two bits
		of the state byte).

</span></div><div class="anchor value-res" id="name-Receiving">	<input type='checkbox' class="fold" id="Receiving-fold-content"><label for="Receiving-fold-content">const <a href="../../src/mellium.im/sasl/negotiator.go.html#line-39">Receiving</a> <a href="#name-State">State</a> = 32</label><span id='Receiving-fold-content-docs' class="fold-docs">
		Receiving bit is on if the machine is a server.

</span></div><div class="anchor value-res" id="name-RemoteCB">	<input type='checkbox' class="fold" id="RemoteCB-fold-content"><label for="RemoteCB-fold-content">const <a href="../../src/mellium.im/sasl/negotiator.go.html#line-33">RemoteCB</a> <a href="#name-State">State</a> = 8</label><span id='RemoteCB-fold-content-docs' class="fold-docs">
		RemoteCB bit is on if the remote client or server supports channel binding.

</span></div><div class="anchor value-res" id="name-ResponseSent">	<input type='checkbox' class="fold" id="ResponseSent-fold-content"><label for="ResponseSent-fold-content">const <a href="../../src/mellium.im/sasl/negotiator.go.html#line-24">ResponseSent</a> <a href="#name-State">State</a> = 2</label><span id='ResponseSent-fold-content-docs' class="fold-docs">
		The current step of the Server or Client (represented by the first two bits
		of the state byte).

</span></div><div class="anchor value-res" id="name-StepMask">	<input type='checkbox' class="fold" id="StepMask-fold-content"><label for="StepMask-fold-content">const <a href="../../src/mellium.im/sasl/negotiator.go.html#line-28">StepMask</a> = 3</label><span id='StepMask-fold-content-docs' class="fold-docs">
		Bitmask used for extracting the step from the state byte.

</span></div><div class="anchor value-res" id="name-ValidServerResponse">	<input type='checkbox' class="fold" id="ValidServerResponse-fold-content"><label for="ValidServerResponse-fold-content">const <a href="../../src/mellium.im/sasl/negotiator.go.html#line-25">ValidServerResponse</a> <a href="#name-State">State</a> = 3</label><span id='ValidServerResponse-fold-content-docs' class="fold-docs">
		The current step of the Server or Client (represented by the first two bits
		of the state byte).

</span></div>	<input type='checkbox' class="showhide" id="unexported-constants-showhide"><i><label for="unexported-constants-showhide" class="show-inline">/* 5 unexporteds ... */</label><label for="unexported-constants-showhide" class="hide-inline">/* 5 unexporteds: */</label></i><div class="anchor value-res hidden" id="name-gs2HeaderCBSupport"><i>	<span class="nodocs">const <a href="../../src/mellium.im/sasl/scram.go.html#line-20">gs2HeaderCBSupport</a> = "p=tls-unique,"</span></i></div><div class="anchor value-res hidden" id="name-gs2HeaderNoCBSupport"><i>	<span class="nodocs">const <a href="../../src/mellium.im/sasl/scram.go.html#line-22">gs2HeaderNoCBSupport</a> = "n,"</span></i></div><div class="anchor value-res hidden" id="name-gs2HeaderNoServerCBSupport"><i>	<span class="nodocs">const <a href="../../src/mellium.im/sasl/scram.go.html#line-21">gs2HeaderNoServerCBSupport</a> = "y,"</span></i></div><div class="anchor value-res hidden" id="name-noncerandlen"><i>	<input type='checkbox' class="fold" id="noncerandlen-fold-content"><label for="noncerandlen-fold-content">const <a href="../../src/mellium.im/sasl/scram.go.html#line-31">noncerandlen</a> = 16</label><span id='noncerandlen-fold-content-docs' class="fold-docs">
		The number of random bytes to generate for a nonce.

</span></i></div><div class="anchor value-res hidden" id="name-wordSize"><i>	<span class="nodocs">const <a href="../../src/mellium.im/sasl/xor_unaligned.go.html#line-15">wordSize</a> <a href="../builtin.html#name-int">int</a> = 8</span></i></div></div></code></pre><pre id="footer">
<table><tr><td><img src="../../png/go101-twitter.png"></td>
<td>The pages are generated with <a href="https://go101.org/article/tool-golds.html"><b>Golds</b></a> <i>v0.3.6</i>. (GOOS=darwin GOARCH=amd64)
<b>Golds</b> is a <a href="https://go101.org">Go 101</a> project developed by <a href="https://tapirgames.com">Tapir Liu</a>.
PR and bug reports are welcome and can be submitted to <a href="https://github.com/go101/golds">the issue list</a>.
Please follow <a href="https://twitter.com/go100and1">@Go100and1</a> (reachable from the left QR code) to get the latest news of <b>Golds</b>.</td></tr></table></pre>